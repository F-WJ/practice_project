<!DOCTYPE html>
<html>
<head>
<title>Flask+Gunicorn+docker搭建 - 幕布</title>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="renderer" content="webkit"/>
<meta name="author" content="mubu.com"/>
</head>
<body style="margin: 50px 20px;color: #333;font-family: 'Helvetica Neue','Hiragino Sans GB','WenQuanYi Micro Hei','Microsoft Yahei',sans-serif;">
<div class="export-wrapper"><div style="font-size: 24px; padding: 20px 15px 0;"><div style="padding-bottom: 10px">Flask+Gunicorn+docker搭建</div><div style="background: #e5e6e8; height: 1px; margin-bottom: 20px;"></div></div><ul style="list-style: disc outside;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">flask Dockerfile配置</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">下载项目代码</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">git clone git@github.com:F-WJ/studentregister.git</span></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"><a class="content-link" target="_blank" href="https://github.com/F-WJ/studentregister" style="text-decoration: underline; opacity: 0.6; color: inherit;">https://github.com/F-WJ/studentregister</a></span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">配置pip.conf国内源</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22ow%22%3A534%2C%22oh%22%3A105%2C%22id%22%3A%2222c167b4ab9b4a0c7-1234351%22%2C%22uri%22%3A%22document_image%2F1ab7cc18-bfec-4958-a373-940b250209db-1234351.jpg%22%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/1ab7cc18-bfec-4958-a373-940b250209db-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">修改ubuntu软件更新的源服务器地址（sources.list）</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22ow%22%3A741%2C%22oh%22%3A207%2C%22id%22%3A%229f167b4b0afbe172-1234351%22%2C%22uri%22%3A%22document_image%2F914db0b2-0ff9-45d2-add4-dce450a4f137-1234351.jpg%22%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/914db0b2-0ff9-45d2-add4-dce450a4f137-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">gunicorn</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">简单介绍</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">gunicorn，是“Green Unicorn”，脱胎于ruby社区的Unicorn，移植到python上，成为一个WSGI HTTP Server，WSGI是”Web Server Gateway Interface”，是python的web接口规范。</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">安装</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">pip install gunicorn</span></li></ul></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">编写Dockerfile</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22id%22%3A%2223167b7a22e8215d-1234351%22%2C%22uri%22%3A%22document_image%2Fab1d5cfd-73a7-4e95-bcb5-26def2961c10-1234351.jpg%22%2C%22ow%22%3A1379%2C%22oh%22%3A883%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/ab1d5cfd-73a7-4e95-bcb5-26def2961c10-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">mysql Dockerfile配置</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22ow%22%3A1667%2C%22oh%22%3A602%2C%22id%22%3A%22166167b4e16d95015-1234351%22%2C%22uri%22%3A%22document_image%2Fb8e215dc-c0db-4c56-83c1-c59f3143087d-1234351.jpg%22%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">下载mysql镜像</span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/b8e215dc-c0db-4c56-83c1-c59f3143087d-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">启动容器</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">资料</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"><a class="content-link" target="_blank" href="https://github.com/zhangpeihao/LearningDocker/blob/master/manuscript/04-WriteDockerfile.md" style="text-decoration: underline; opacity: 0.6; color: inherit;">https://github.com/zhangpeihao/LearningDocker/blob/master/manuscript/04-WriteDockerfile.md</a></span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">docker run -d -p 13306:3306 --name mysql2 -v /opt/mydata/:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=password  mysql:latest</span></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">mysql启动时自动创建数据库</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22id%22%3A%22139167b78f87a70b3-1234351%22%2C%22uri%22%3A%22document_image%2F1bb63746-f0ca-4a79-9709-33a650299214-1234351.jpg%22%2C%22ow%22%3A875%2C%22oh%22%3A138%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">Dockerfile设置</span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/1bb63746-f0ca-4a79-9709-33a650299214-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">准备sql文件</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22id%22%3A%2211f167b79097d105b-1234351%22%2C%22uri%22%3A%22document_image%2F2771dff7-71fe-45f3-931c-70f11ecc7e5a-1234351.jpg%22%2C%22ow%22%3A402%2C%22oh%22%3A105%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/2771dff7-71fe-45f3-931c-70f11ecc7e5a-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">创建镜像</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">docker build -t mysql:5.7 .</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">参考资料</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"><a class="content-link" target="_blank" href="https://k.latelee.org/posts/%E6%88%91%E7%9A%84docker%E9%9A%8F%E7%AC%9418-MySQL%E5%90%AF%E5%8A%A8%E6%97%B6%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93.html" style="text-decoration: underline; opacity: 0.6; color: inherit;">https://k.latelee.org/posts/%E6%88%91%E7%9A%84docker%E9%9A%8F%E7%AC%9418-MySQL%E5%90%AF%E5%8A%A8%E6%97%B6%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93.html</a></span></li></ul></li></ul></li></ul></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">Docker Compose</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">安装</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22ow%22%3A717%2C%22oh%22%3A577%2C%22id%22%3A%223bc167b5c483480f-1234351%22%2C%22uri%22%3A%22document_image%2F9e2bdd68-1b02-4e19-97ae-4b1ca8a35018-1234351.jpg%22%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/9e2bdd68-1b02-4e19-97ae-4b1ca8a35018-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">部分配置详解</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">image</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">指定镜像tag或者ID。</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">links</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">用于链接另一容器服务，如需要使用到另一容器的mysql服务。可以给出服务名和别名；也可以仅给出服务名，这样别名将和服务名相同。同docker run --link。示例</span></li><li style="line-height: 22px;"><span class="content mubu-node" images="%5B%7B%22id%22%3A%222ed167b7978900164-1234351%22%2C%22uri%22%3A%22document_image%2F0af07210-5347-4d35-b3ac-6bbe99645eb7-1234351.jpg%22%2C%22ow%22%3A787%2C%22oh%22%3A185%7D%5D" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"></span><div style="padding: 3px 0"><img src="https://mubu.com/document_image/0af07210-5347-4d35-b3ac-6bbe99645eb7-1234351.jpg" style="max-width: 720px;" class="attach-img"></div></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">ports</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">用于暴露端口。同docker run -p。</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">volumes</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">挂载数据卷。同docker run -v。</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">environment</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">添加环境变量。同docker run -e。可以是数组或者字典格式</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">depends_on</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">用于指定服务依赖，一般是mysql、redis等。 指定了依赖，将会优先于服务创建并启动依赖。</span></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">links也可以指定依赖。</span></li></ul></li><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">参考资料</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;">docker-compose.yml配置详解</span><ul class="children" style="list-style: disc outside; padding-bottom: 4px;"><li style="line-height: 22px;"><span class="content mubu-node" style="line-height: 22px; min-height: 22px; font-size: 14px; display: inline-block; vertical-align: top;"><a class="content-link" target="_blank" href="https://juejin.im/post/5aed4a776fb9a07a9918bb42" style="text-decoration: underline; opacity: 0.6; color: inherit;">https://juejin.im/post/5aed4a776fb9a07a9918bb42</a></span></li></ul></li></ul></li></ul></li></ul></li></ul></div>

</body>
</html>